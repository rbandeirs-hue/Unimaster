{% extends "base.html" %}
{% block title %}Meu Perfil – {{ aluno.nome }}{% endblock %}

{% block content %}
<div class="container mt-4">
    {% if alunos|length > 1 %}
    <div class="mb-3">
        <label class="form-label fw-semibold">Aluno:</label>
        <select class="form-select form-select-sm" style="max-width: 280px;" onchange="if(this.value) window.location.href='{{ url_for('painel_responsavel.meu_perfil') }}?aluno_id='+this.value">
            {% for a in alunos %}
            <option value="{{ a.id }}" {% if a.id == aluno.id %}selected{% endif %}>{{ a.nome }}</option>
            {% endfor %}
        </select>
    </div>
    {% endif %}

    <div class="mb-4">
        <h2 class="fw-bold text-primary">Meu Perfil</h2>
        <p class="text-muted mb-0">Informações do aluno — {{ aluno.nome }}</p>
    </div>

    <div class="row g-4">
        <!-- Coluna esquerda: Perfil do Aluno -->
        <div class="col-lg-4 col-md-5">
            <div class="card shadow-sm border-primary painel-perfil-card">
                <div class="card-body p-4">
                    <div class="perfil-card-content">
                        <div class="perfil-foto-wrap">
                            {% if aluno and aluno.foto %}
                            <img src="{{ url_for('static', filename='uploads/' + aluno.foto) }}" alt="Foto do aluno" class="perfil-foto">
                            {% else %}
                            <div class="perfil-foto-placeholder"><i class="bi bi-person-fill"></i></div>
                            {% endif %}
                        </div>
                        <h5 class="fw-bold text-center mb-3 mt-2">Perfil do aluno</h5>
                        <div class="perfil-dados">
                            <div class="perfil-item"><span class="perfil-label">Academia</span><span class="perfil-valor">{{ aluno.academia_nome or '—' }}</span></div>
                            <div class="perfil-item"><span class="perfil-label">Turma</span><span class="perfil-valor">{{ aluno.turma_nome or '—' }}</span></div>
                            <div class="perfil-item"><span class="perfil-label">Modalidades</span><span class="perfil-valor">{% if aluno.modalidades_nomes and aluno.modalidades_nomes != '-' %}{{ aluno.modalidades_nomes }}{% elif aluno.modalidades %}{% if aluno.modalidades[0] is mapping %}{{ aluno.modalidades | map(attribute='nome') | join(', ') }}{% else %}{{ aluno.modalidades | join(', ') }}{% endif %}{% else %}—{% endif %}</span></div>
                            <div class="perfil-item"><span class="perfil-label">Faixa</span><span class="perfil-valor">{% if aluno.faixa_nome or aluno.graduacao_nome %}{{ aluno.faixa_nome or '' }}{% if aluno.faixa_nome and aluno.graduacao_nome %} ({{ aluno.graduacao_nome }}){% elif aluno.graduacao_nome %}{{ aluno.graduacao_nome }}{% endif %}{% else %}—{% endif %}</span></div>
                            <div class="perfil-item"><span class="perfil-label">Próxima faixa</span><span class="perfil-valor">{{ aluno.proxima_faixa|default('—') }}</span></div>
                        </div>
                        <div class="perfil-card-actions d-flex gap-2 mt-3 w-100 justify-content-center">
                            <a href="{{ url_for('alunos.editar_aluno', aluno_id=aluno.id, next=url_for('painel_responsavel.meu_perfil', aluno_id=aluno.id)) }}" class="btn btn-outline-warning btn-sm" title="Editar dados">
                                <i class="bi bi-pencil-fill"></i> Editar
                            </a>
                            <button type="button" class="btn btn-outline-primary btn-sm" data-bs-toggle="modal" data-bs-target="#modalVerAluno" title="Ver dados completos">
                                <i class="bi bi-eye-fill"></i> Ver
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Coluna direita: atalhos -->
        <div class="col-lg-8 col-md-7">
            <div class="row g-2">
                <div class="col-sm-6 col-12">
                    <a href="{{ url_for('eventos_competicoes.disponiveis', aluno_id=aluno.id) }}" class="text-decoration-none">
                        <div class="card shadow-sm border-danger card-hover painel-atalho-card">
                            <div class="card-body text-center py-3 px-3 d-flex flex-column align-items-center">
                                <i class="bi bi-trophy fs-3 mb-2 text-danger"></i>
                                <h6 class="fw-bold mb-1">Eventos e Competições</h6>
                                <p class="text-muted small mb-2">Realizar inscrições</p>
                                <span class="btn btn-danger btn-sm px-3">Acessar</span>
                            </div>
                        </div>
                    </a>
                </div>
                <div class="col-sm-6 col-12">
                    <a href="{{ url_for('calendario.aluno_responsavel', aluno_id=aluno.id) }}" class="text-decoration-none">
                        <div class="card shadow-sm border-info card-hover painel-atalho-card">
                            <div class="card-body text-center py-3 px-3 d-flex flex-column align-items-center">
                                <i class="bi bi-calendar-event fs-3 mb-2 text-info"></i>
                                <h6 class="fw-bold mb-1">Calendário</h6>
                                <p class="text-muted small mb-2">Eventos e aulas</p>
                                <span class="btn btn-info btn-sm text-white px-3">Acessar</span>
                            </div>
                        </div>
                    </a>
                </div>
                <div class="col-sm-6 col-12">
                    <a href="{{ url_for('painel_responsavel.minhas_mensalidades', aluno_id=aluno.id) }}" class="text-decoration-none">
                        <div class="card shadow-sm border-success card-hover painel-atalho-card">
                            <div class="card-body text-center py-3 px-3 d-flex flex-column align-items-center">
                                <i class="bi bi-calendar-check fs-3 mb-2 text-success"></i>
                                <h6 class="fw-bold mb-1">Mensalidades</h6>
                                <p class="text-muted small mb-2">Vencimentos e pagamentos</p>
                                <span class="btn btn-success btn-sm px-3">Acessar</span>
                            </div>
                        </div>
                    </a>
                </div>
                <div class="col-sm-6 col-12">
                    <a href="{{ url_for('painel_responsavel.minha_turma', aluno_id=aluno.id) }}" class="text-decoration-none">
                        <div class="card shadow-sm border-info card-hover painel-atalho-card">
                            <div class="card-body text-center py-3 px-3 d-flex flex-column align-items-center">
                                <i class="bi bi-collection fs-3 mb-2 text-info"></i>
                                <h6 class="fw-bold mb-1">Turma</h6>
                                <p class="text-muted small mb-2">Horários e informações</p>
                                <span class="btn btn-info btn-sm text-white px-3">Acessar</span>
                            </div>
                        </div>
                    </a>
                </div>
                <div class="col-sm-6 col-12">
                    <a href="{{ url_for('painel_responsavel.minhas_presencas', aluno_id=aluno.id) }}" class="text-decoration-none">
                        <div class="card shadow-sm border-warning card-hover painel-atalho-card">
                            <div class="card-body text-center py-3 px-3 d-flex flex-column align-items-center">
                                <i class="bi bi-clipboard-check fs-3 mb-2 text-warning"></i>
                                <h6 class="fw-bold mb-1">Presenças</h6>
                                <p class="text-muted small mb-2">Histórico de presença</p>
                                <span class="btn btn-warning btn-sm text-dark px-3">Acessar</span>
                            </div>
                        </div>
                    </a>
                </div>
                <div class="col-sm-6 col-12">
                    <a href="{{ url_for('painel_responsavel.curriculo', aluno_id=aluno.id) }}" class="text-decoration-none">
                        <div class="card shadow-sm border-secondary card-hover painel-atalho-card">
                            <div class="card-body text-center py-3 px-3 d-flex flex-column align-items-center">
                                <i class="bi bi-file-earmark-person fs-3 mb-2 text-secondary"></i>
                                <h6 class="fw-bold mb-1">Currículo</h6>
                                <p class="text-muted small mb-2">Competições e eventos</p>
                                <span class="btn btn-secondary btn-sm px-3">Acessar</span>
                            </div>
                        </div>
                    </a>
                </div>
                <div class="col-sm-6 col-12">
                    <a href="{{ url_for('painel_responsavel.associacao', aluno_id=aluno.id) }}" class="text-decoration-none">
                        <div class="card shadow-sm border-dark card-hover painel-atalho-card">
                            <div class="card-body text-center py-3 px-3 d-flex flex-column align-items-center">
                                <i class="bi bi-building fs-3 mb-2 text-dark"></i>
                                <h6 class="fw-bold mb-1">Associação</h6>
                                <p class="text-muted small mb-2">Academias vinculadas</p>
                                <span class="btn btn-dark btn-sm px-3">Acessar</span>
                            </div>
                        </div>
                    </a>
                </div>
                <div class="col-sm-6 col-12">
                    <a href="{{ url_for('painel_responsavel.simular_categorias', aluno_id=aluno.id) }}" class="text-decoration-none">
                        <div class="card shadow-sm border-primary card-hover painel-atalho-card">
                            <div class="card-body text-center py-3 px-3 d-flex flex-column align-items-center">
                                <i class="bi bi-trophy fs-3 mb-2 text-primary"></i>
                                <h6 class="fw-bold mb-1">Simular Categorias</h6>
                                <p class="text-muted small mb-2">Ver categorias disponíveis</p>
                                <span class="btn btn-primary btn-sm px-3">Acessar</span>
                            </div>
                        </div>
                    </a>
                </div>
                <div class="col-sm-6 col-12">
                    <a href="{{ url_for('painel_responsavel.simular_graduacao_prevista', aluno_id=aluno.id) }}" class="text-decoration-none">
                        <div class="card shadow-sm border-info card-hover painel-atalho-card">
                            <div class="card-body text-center py-3 px-3 d-flex flex-column align-items-center">
                                <i class="bi bi-calendar-check fs-3 mb-2 text-info"></i>
                                <h6 class="fw-bold mb-1">Graduação Prevista</h6>
                                <p class="text-muted small mb-2">Linha do tempo de graduações</p>
                                <span class="btn btn-info btn-sm px-3">Acessar</span>
                            </div>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal Ver dados do aluno -->
<div class="modal fade" id="modalVerAluno" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered modal-lg modal-dialog-scrollable">
    <div class="modal-content border-0 shadow-lg">
      <div class="modal-header">
        <h5 class="modal-title fw-bold"><i class="bi bi-person-badge me-2"></i>{{ aluno.nome }}</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <!-- Indicadores de Slide -->
        <div class="modal-slide-indicators mb-3 d-flex justify-content-center gap-2 flex-wrap">
          <button class="slide-indicator active" data-slide="0" title="Dados Pessoais">
            <i class="bi bi-person-vcard"></i>
          </button>
          <button class="slide-indicator" data-slide="1" title="Acadêmico">
            <i class="bi bi-award"></i>
          </button>
          <button class="slide-indicator" data-slide="2" title="Peso & Categoria">
            <i class="bi bi-bar-chart-line"></i>
          </button>
          <button class="slide-indicator" data-slide="3" title="Frequência">
            <i class="bi bi-graph-up-arrow"></i>
          </button>
          <button class="slide-indicator" data-slide="4" title="Aptidão">
            <i class="bi bi-clipboard-check"></i>
          </button>
          {% if aluno.observacoes %}
          <button class="slide-indicator" data-slide="5" title="Observações">
            <i class="bi bi-journal-text"></i>
          </button>
          {% endif %}
        </div>

        <!-- Container de Slides -->
        <div class="modal-slides-container position-relative">
          <!-- Slide 1: Dados Pessoais -->
          <div class="modal-slide active" data-slide-index="0">
            <div class="modal-section-perfil h-100">
              <h6><i class="bi bi-person-vcard"></i> Dados Pessoais</h6>
              <div class="modal-info-item"><span>Nascimento</span><strong>{{ aluno.data_nascimento_formatada or (aluno.data_nascimento|data_br if aluno.data_nascimento else '—') }}{% if aluno.idade_real %} ({{ aluno.idade_real }} anos){% endif %}</strong></div>
              <div class="modal-info-item"><span>CPF</span><strong>{{ aluno.cpf or '—' }}</strong></div>
              <div class="modal-info-item"><span>Telefone</span><strong>{{ aluno.telefone_celular or aluno.telefone or '—' }}</strong></div>
              <div class="modal-info-item"><span>Email</span><strong>{{ aluno.email or '—' }}</strong></div>
              <div class="modal-info-item"><span>Responsável</span><strong>{{ aluno.responsavel_nome or aluno.responsavel or '—' }}</strong></div>
              <div class="modal-info-item"><span>Responsável financeiro</span><strong>{{ aluno.responsavel_financeiro_nome or '—' }}</strong></div>
            </div>
          </div>

          <!-- Slide 2: Acadêmico -->
          <div class="modal-slide" data-slide-index="1">
            <div class="modal-section-perfil h-100">
              <h6><i class="bi bi-award"></i> Acadêmico</h6>
              <div class="modal-info-item"><span>Academia</span><strong>{{ aluno.academia_nome or '—' }}</strong></div>
              <div class="modal-info-item"><span>Turma</span><strong>{{ aluno.turma_nome or '—' }}</strong></div>
              <div class="modal-info-item"><span>Faixa</span><strong>{% if aluno.faixa_nome or aluno.graduacao_nome or aluno.faixa or aluno.graduacao %}{{ aluno.faixa_nome or aluno.faixa or '' }}{% if (aluno.faixa_nome or aluno.faixa) and (aluno.graduacao_nome or aluno.graduacao) %} ({{ aluno.graduacao_nome or aluno.graduacao }}){% elif aluno.graduacao_nome or aluno.graduacao %}{{ aluno.graduacao_nome or aluno.graduacao }}{% endif %}{% else %}—{% endif %}</strong></div>
              <div class="modal-info-item"><span>Próxima faixa</span><strong>{{ aluno.proxima_faixa|default('—') }}</strong></div>
              <div class="modal-info-item"><span>Último exame</span><strong>{{ aluno.ultimo_exame_faixa_formatada|default('—') }}</strong></div>
              <div class="modal-info-item"><span>Elegível em</span><strong>{{ aluno.data_elegivel|default('—') }}</strong></div>
              <div class="modal-info-item"><span>Modalidades</span><strong>{% if aluno.modalidades_nomes and aluno.modalidades_nomes != '-' %}{{ aluno.modalidades_nomes }}{% elif aluno.modalidades %}{% if aluno.modalidades[0] is mapping %}{{ aluno.modalidades | map(attribute='nome') | join(', ') }}{% else %}{{ aluno.modalidades | join(', ') }}{% endif %}{% else %}—{% endif %}</strong></div>
              <div class="modal-info-item"><span>Peso</span><strong>{{ aluno.peso or '—' }}{% if aluno.peso %} kg{% endif %}</strong></div>
            </div>
          </div>

          <!-- Slide 3: Peso & Categoria -->
          <div class="modal-slide" data-slide-index="2">
            <div class="modal-section-perfil h-100">
              <h6><i class="bi bi-bar-chart-line"></i> Peso & Categoria</h6>
              <div class="mb-3 text-center">
                <div class="d-inline-block p-3 bg-light rounded border" style="min-width: 150px;">
                  <div class="display-6 fw-bold text-primary">{{ aluno.peso or '—' }}{% if aluno.peso %}<span class="fs-5 fw-normal"> kg</span>{% endif %}</div>
                  <div class="small text-muted">Peso</div>
                </div>
              </div>
              <div class="mt-3">
                <div class="small text-muted mb-2 fw-semibold">Categorias Disponíveis</div>
                {% if aluno.categorias_disponiveis and aluno.categorias_disponiveis|length > 0 %}
                  <div class="d-flex flex-column gap-2">
                    {% for cat in aluno.categorias_disponiveis %}
                      <div class="alert alert-info mb-0 py-2">
                        <i class="bi bi-tag me-2"></i>
                        {% if cat.id_classe %}<strong>{{ cat.id_classe }}</strong> - {% endif %}
                        {{ cat.nome_categoria or cat.categoria or '-' }}
                      </div>
                    {% endfor %}
                  </div>
                {% else %}
                  <div class="text-muted small">
                    <i class="bi bi-info-circle me-1"></i>{{ aluno.categorias_texto or 'Não disponível' }}
                  </div>
                {% endif %}
              </div>
            </div>
          </div>

          <!-- Slide 4: Frequência -->
          <div class="modal-slide" data-slide-index="3">
            <div class="modal-section-perfil h-100">
              <h6><i class="bi bi-graph-up-arrow"></i> Frequência (Judô)</h6>
              <div class="d-flex gap-3 flex-wrap justify-content-center mb-3">
                <div class="text-center p-3 bg-light rounded border" style="min-width: 100px;">
                  <div class="h4 fw-bold text-primary mb-1">{{ aluno.frequencia_ano or '—' }}{% if aluno.frequencia_ano is not none %}%{% endif %}</div>
                  <div class="small text-muted">Ano atual</div>
                </div>
                <div class="text-center p-3 bg-light rounded border" style="min-width: 100px;">
                  <div class="h4 fw-bold text-primary mb-1">{{ aluno.frequencia_mes or '—' }}{% if aluno.frequencia_mes is not none %}%{% endif %}</div>
                  <div class="small text-muted">Mês atual</div>
                </div>
                <div class="text-center p-3 bg-light rounded border" style="min-width: 100px;">
                  <div class="h4 fw-bold text-primary mb-1">{{ aluno.frequencia_desde_exame or '—' }}{% if aluno.frequencia_desde_exame is not none %}%{% endif %}</div>
                  <div class="small text-muted">Desde exame</div>
                </div>
              </div>
              {% if aluno.total_aulas_desde and aluno.total_aulas_desde > 0 %}
              <div class="alert alert-light border mb-0">
                <i class="bi bi-check-circle me-2"></i>
                <strong>Presenças:</strong> {{ aluno.presentes_desde or 0 }} / {{ aluno.total_aulas_desde }} aulas
              </div>
              {% endif %}
              <p class="small text-muted mb-0 mt-2 text-center">Mín. 70% desde último exame para aptidão.</p>
            </div>
          </div>

          <!-- Slide 5: Aptidão -->
          <div class="modal-slide" data-slide-index="4">
            <div class="modal-section-perfil h-100">
              <h6><i class="bi bi-clipboard-check"></i> Aptidão para Exame</h6>
              <div class="d-flex flex-column gap-3 align-items-center">
                <div class="w-100 text-center">
                  <span class="badge {% if aluno.aptidao_status == 'Apto' %}bg-success{% elif aluno.aptidao_status == 'Inapto' %}bg-danger{% elif aluno.aptidao_status == 'Sem próxima faixa' %}bg-warning text-dark{% else %}bg-secondary{% endif %} py-3 px-4" style="font-size: 1.1rem;">
                    {% if aluno.aptidao_status == 'Apto' %}
                      <i class="bi bi-check-circle me-2"></i>APTO PARA EXAME
                    {% elif aluno.aptidao_status == 'Inapto' %}
                      <i class="bi bi-x-circle me-2"></i>INAPTO PARA EXAME
                    {% elif aluno.aptidao_status == 'Sem próxima faixa' %}
                      <i class="bi bi-info-circle me-2"></i>SEM PRÓXIMA FAIXA
                    {% else %}
                      <i class="bi bi-dash-circle me-2"></i>{{ aluno.aptidao_status|default('NÃO DEFINIDO') }}
                    {% endif %}
                  </span>
                </div>
                {% if aluno.proxima_faixa and aluno.proxima_faixa not in ['—', '-', ''] %}
                <div class="w-100">
                  <div class="alert alert-success mb-0">
                    <i class="bi bi-trophy me-2"></i>
                    <strong>Próxima faixa:</strong> {{ aluno.proxima_faixa }}
                  </div>
                </div>
                {% endif %}
                {% if aluno.data_elegivel and aluno.data_elegivel not in ['—', '-', ''] %}
                <div class="w-100">
                  <div class="alert alert-info mb-0">
                    <i class="bi bi-calendar3 me-2"></i>
                    <strong>Elegível em:</strong> {{ aluno.data_elegivel }}
                  </div>
                </div>
                {% endif %}
                {% if aluno.motivo and aluno.motivo.strip() and aluno.motivo.strip() not in ['—', '-', ''] %}
                <div class="w-100">
                  <div class="alert {% if aluno.aptidao_status == 'Inapto' %}alert-warning{% else %}alert-info{% endif %} mb-0">
                    <i class="bi bi-exclamation-triangle me-2"></i>
                    <strong>{% if aluno.aptidao_status == 'Inapto' %}Motivo da Inaptidão:{% else %}Informação:{% endif %}</strong>
                    <div class="mt-2">
                      {% set motivos_lista = aluno.motivo.split('; ') %}
                      <ul class="mb-0 ps-3">
                        {% for motivo_item in motivos_lista %}
                        <li>{{ motivo_item }}</li>
                        {% endfor %}
                      </ul>
                    </div>
                  </div>
                </div>
                {% endif %}
                {% if aluno.frequencia_desde_exame is not none %}
                <div class="w-100">
                  <div class="alert alert-light border mb-0">
                    <i class="bi bi-graph-up-arrow me-2"></i>
                    <strong>Frequência desde último exame:</strong> {{ aluno.frequencia_desde_exame }}%
                    {% if aluno.frequencia_desde_exame < 70 %}
                      <span class="badge bg-danger ms-2">Abaixo do mínimo (70%)</span>
                    {% else %}
                      <span class="badge bg-success ms-2">Aprovado</span>
                    {% endif %}
                  </div>
                </div>
                {% endif %}
              </div>
            </div>
          </div>

          <!-- Slide 6: Observações (se houver) -->
          {% if aluno.observacoes %}
          <div class="modal-slide" data-slide-index="5">
            <div class="modal-section-perfil h-100">
              <h6><i class="bi bi-journal-text"></i> Observações</h6>
              <p class="mb-0 text-muted">{{ aluno.observacoes }}</p>
            </div>
          </div>
          {% endif %}
        </div>

        <!-- Controles de Navegação -->
        <div class="modal-slide-controls d-flex justify-content-between align-items-center mt-4">
          <button class="btn btn-outline-primary slide-btn-prev" type="button">
            <i class="bi bi-chevron-left me-1"></i> Anterior
          </button>
          <span class="slide-counter">
            <span class="slide-current">1</span> / <span class="slide-total">{{ 5 + (1 if aluno.observacoes else 0) }}</span>
          </span>
          <button class="btn btn-outline-primary slide-btn-next" type="button">
            Próximo <i class="bi bi-chevron-right ms-1"></i>
          </button>
        </div>
      </div>
      <div class="modal-footer border-0 bg-light">
        <a href="{{ url_for('alunos.editar_aluno', aluno_id=aluno.id, next=url_for('painel_responsavel.meu_perfil', aluno_id=aluno.id)) }}" class="btn btn-warning"><i class="bi bi-pencil me-1"></i> Editar</a>
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
      </div>
    </div>
  </div>
</div>

<style>
.modal-section-perfil {
  border-radius: 12px;
  padding: 1rem 1.25rem;
  background: #f8f9fa;
  border: 1px solid #e9ecef;
  height: 100%;
}
.modal-section-perfil h6 {
  font-size: 0.8rem;
  font-weight: 700;
  color: #0d6efd;
  margin-bottom: 1rem;
  padding-bottom: 0.5rem;
  border-bottom: 1px solid #dee2e6;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}
.modal-section-perfil .modal-info-item {
  display: grid;
  grid-template-columns: 1fr auto;
  align-items: center;
  gap: 1rem;
  font-size: 0.9rem;
  padding: 0.5rem 0;
  border-bottom: 1px solid #e9ecef;
}
.modal-section-perfil .modal-info-item:last-child { border-bottom: none; }
.modal-section-perfil .modal-info-item span { color: #6c757d; font-weight: 500; }
.modal-section-perfil .modal-info-item strong { color: #212529; text-align: right; word-break: break-word; }
.perfil-card-actions .btn { min-width: 90px; }
.perfil-card-content { display: flex; flex-direction: column; align-items: center; }
.painel-perfil-card { align-self: flex-start; }
.painel-atalho-card { transition: 0.2s ease; }
.card { border-radius: 0.75rem; transition: 0.2s ease; }
.card:hover, .card-hover:hover { transform: translateY(-5px); box-shadow: 0 0.6rem 1.2rem rgba(0,0,0,0.15) !important; }
.perfil-foto-wrap {
    width: 100px; height: 100px; border-radius: 50%; overflow: hidden;
    background: #e9ecef; display: flex; align-items: center; justify-content: center;
    border: 3px solid rgba(13, 110, 253, 0.3);
}
.perfil-foto { width: 100%; height: 100%; object-fit: cover; }
.perfil-foto-placeholder { width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; font-size: 2.5rem; color: #6c757d; }
.perfil-dados { width: 100%; }
.perfil-item { display: flex; justify-content: space-between; align-items: flex-start; gap: 0.75rem; padding: 0.35rem 0; border-bottom: 1px solid rgba(0,0,0,0.06); font-size: 0.875rem; }
.perfil-item:last-of-type { border-bottom: none; }
.perfil-label { font-weight: 600; color: #495057; flex-shrink: 0; }
.perfil-valor { color: #212529; text-align: right; word-break: break-word; }
/* Sistema de Slides */
.modal-slide-indicators { flex-wrap: wrap; padding: 0.5rem 0; }
.slide-indicator {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  border: 2px solid #dee2e6;
  background: #fff;
  color: #6c757d;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.3s ease;
  font-size: 1.1rem;
}
.slide-indicator:hover {
  border-color: #0d6efd;
  color: #0d6efd;
  transform: scale(1.1);
}
.slide-indicator.active {
  background: #0d6efd;
  border-color: #0d6efd;
  color: #fff;
}
.modal-slides-container {
  min-height: 300px;
  position: relative;
  overflow: hidden;
}
.modal-slide {
  display: none;
  animation: slideIn 0.3s ease;
}
.modal-slide.active {
  display: block;
}
@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateX(20px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
.modal-slide-controls {
  padding: 1rem 0;
  border-top: 1px solid #dee2e6;
}
.slide-counter {
  font-weight: 600;
  color: #495057;
}
.slide-btn-prev, .slide-btn-next {
  min-width: 120px;
}
@media (max-width: 576px) {
  .slide-indicator {
    width: 35px;
    height: 35px;
    font-size: 0.95rem;
  }
  .slide-btn-prev, .slide-btn-next {
    min-width: 100px;
    font-size: 0.875rem;
    padding: 0.4rem 0.6rem;
  }
  .modal-slides-container {
    min-height: 250px;
  }
}
</style>
<script>
// Sistema de Slides no Modal
document.addEventListener('DOMContentLoaded', function() {
  const modal = document.getElementById('modalVerAluno');
  if (!modal) return;

  const slidesContainer = modal.querySelector('.modal-slides-container');
  const slides = slidesContainer ? slidesContainer.querySelectorAll('.modal-slide') : [];
  const indicators = modal.querySelectorAll('.slide-indicator');
  const prevBtn = modal.querySelector('.slide-btn-prev');
  const nextBtn = modal.querySelector('.slide-btn-next');
  const currentSpan = modal.querySelector('.slide-current');
  const totalSpan = modal.querySelector('.slide-total');
  
  if (!slides.length) return;

  let currentSlide = 0;
  const totalSlides = slides.length;

  if (totalSpan) {
    totalSpan.textContent = totalSlides;
  }

  function updateSlide(index) {
    if (index < 0) index = totalSlides - 1;
    if (index >= totalSlides) index = 0;
    
    currentSlide = index;

    slides.forEach((slide, i) => {
      slide.classList.toggle('active', i === currentSlide);
    });

    indicators.forEach((indicator, i) => {
      indicator.classList.toggle('active', i === currentSlide);
    });

    if (currentSpan) {
      currentSpan.textContent = currentSlide + 1;
    }

    if (prevBtn) prevBtn.disabled = false;
    if (nextBtn) nextBtn.disabled = false;
  }

  indicators.forEach((indicator, index) => {
    indicator.addEventListener('click', function() {
      updateSlide(index);
    });
  });

  if (prevBtn) {
    prevBtn.addEventListener('click', function() {
      updateSlide(currentSlide - 1);
    });
  }

  if (nextBtn) {
    nextBtn.addEventListener('click', function() {
      updateSlide(currentSlide + 1);
    });
  }

  modal.addEventListener('keydown', function(e) {
    if (e.key === 'ArrowLeft') {
      e.preventDefault();
      updateSlide(currentSlide - 1);
    } else if (e.key === 'ArrowRight') {
      e.preventDefault();
      updateSlide(currentSlide + 1);
    }
  });

  const bsModal = bootstrap.Modal.getInstance(modal);
  if (bsModal) {
    modal.addEventListener('shown.bs.modal', function() {
      updateSlide(0);
      modal.focus();
    });
  }
});
</script>
{% endblock %}
