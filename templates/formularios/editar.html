{% extends "base.html" %}
{% block title %}Editar Formulário{% endblock %}
{% block content %}
<div class="container mt-3 mt-md-5 px-2 px-md-3">
    <div class="mb-3 mb-md-4">
        {% set back_url = back_url or get_back_url_default() %}
{% include 'components/botao_voltar.html' %}
        <h2 class="h5 h4-md fw-bold text-primary">Editar Formulário</h2>
        <p class="text-muted mb-0 small small-md">Altere o nome ou os campos incluídos no formulário.</p>
    </div>

    <div class="card shadow-sm">
        <div class="card-body p-3 p-md-4">
            <form method="POST">
                <div class="mb-3 mb-md-4">
                    <label for="nome" class="form-label fw-semibold">Nome do formulário <span class="text-danger">*</span></label>
                    <input type="text" id="nome" name="nome" class="form-control" required
                           value="{{ formulario.nome }}" maxlength="200">
                </div>

                <div class="mb-3 mb-md-4">
                    <label class="form-label fw-semibold">Status</label>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" name="ativo" value="1" id="ativo"
                               {% if formulario.ativo %}checked{% endif %}>
                        <label class="form-check-label" for="ativo">Ativo</label>
                    </div>
                </div>

                <div class="mb-3 mb-md-4">
                    <label class="form-label fw-semibold">Campos a incluir</label>
                    <p class="small text-muted">Marque os campos que devem aparecer neste formulário.</p>
                    <div class="border rounded p-2 p-md-3 bg-light" style="max-height: 400px; overflow-y: auto; -webkit-overflow-scrolling: touch;">
                        {% for grupo, itens in grupos.items() %}
                        <div class="mb-3">
                            <h6 class="text-primary border-bottom pb-1 mb-2 small small-md">{{ grupo }}</h6>
                            <div class="d-flex flex-column flex-sm-row flex-wrap gap-2">
                                {% for chave, label in itens %}
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="campo_chave" value="{{ chave }}" id="campo_{{ chave }}"
                                           {% if chave in campos_atuais %}checked{% endif %}>
                                    <label class="form-check-label small" for="campo_{{ chave }}">{{ label }}</label>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>

                <div class="d-flex flex-column flex-sm-row gap-2">
                    <button type="submit" class="btn btn-primary w-100 w-sm-auto">
                        <i class="bi bi-check-lg me-1"></i> Salvar Alterações
                    </button>
                    <a href="{{ back_url }}" class="btn btn-outline-secondary w-100 w-sm-auto">Cancelar</a>
                </div>
            </form>
        </div>
    </div>
</div>

<style>
@media (max-width: 767.98px) {
    .form-check-label {
        font-size: 0.85rem;
    }
    
    .form-check-input {
        min-width: 20px;
        min-height: 20px;
    }
    
    .btn {
        min-height: 44px;
    }
}

@media (min-width: 768px) {
    .h4-md {
        font-size: 1.5rem;
    }
    
    .small-md {
        font-size: 1rem;
    }
}
</style>
{% endblock %}
